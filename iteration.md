Iteration
================

## Lists

You can put anything in a list.

``` r
l = list(
  vec_numeric = 5:8,
  vec_logical = c(TRUE, TRUE, FALSE, TRUE, FALSE, FALSE),
  mat = matrix(1:8, nrow = 2, ncol = 4),
  summary = summary(rnorm(100))
)
```

``` r
l
```

    ## $vec_numeric
    ## [1] 5 6 7 8
    ## 
    ## $vec_logical
    ## [1]  TRUE  TRUE FALSE  TRUE FALSE FALSE
    ## 
    ## $mat
    ##      [,1] [,2] [,3] [,4]
    ## [1,]    1    3    5    7
    ## [2,]    2    4    6    8
    ## 
    ## $summary
    ##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
    ## -2.048640 -0.535483  0.001332  0.001124  0.539021  2.211123

``` r
l$vec_numeric
```

    ## [1] 5 6 7 8

``` r
l[[1]] #gives you the first element
```

    ## [1] 5 6 7 8

``` r
mean(l[["vec_numeric"]])
```

    ## [1] 6.5

## `for` loop

create new list

``` r
list_norm = 
  list(
    a = rnorm(20, mean = 3, sd = 1),
    b = rnorm(30, mean = 0, sd = 5),
    c = rnorm(40, mean = 10, sd = .2),
    d = rnorm(20, mean = -3, sd = 1)
  )
```

``` r
list_norm
```

    ## $a
    ##  [1] 2.922404 3.127183 2.772952 3.492463 3.956003 4.264449 3.057104 3.957439
    ##  [9] 2.821668 2.943746 3.269228 3.978526 1.577132 3.019604 2.217397 3.275709
    ## [17] 3.114434 4.676677 2.684247 5.206172
    ## 
    ## $b
    ##  [1] -1.57511583  4.90932517 -0.16892460 -0.30827469  0.32416488  4.91805428
    ##  [7] -0.08356396 -0.72459601 -2.79705521 -5.40523334  0.53962930 -0.85857557
    ## [13] -8.19503303 -1.35298677 -0.14415564  3.36207855  0.32028494 -0.45958939
    ## [19]  4.55586153  2.18591720 -4.93872146  7.25693366  1.01320011  3.20834587
    ## [25] -5.27540115  4.58243042 -2.07466257 -6.97837891  5.23361760 -3.49412097
    ## 
    ## $c
    ##  [1] 10.008858 10.138616  9.829443  9.868863  9.922727  9.658375  9.808352
    ##  [8] 10.044111 10.074619 10.297830  9.703691  9.696770 10.087226 10.243660
    ## [15]  9.743809  9.960003 10.027672  9.892706 10.243072  9.715110 10.063978
    ## [22]  9.684168 10.271074 10.098806 10.308885 10.287393 10.150831 10.082851
    ## [29]  9.809180 10.336344  9.997826  9.656350  9.707188 10.175900 10.012713
    ## [36]  9.815042  9.696131 10.178422  9.865522 10.277250
    ## 
    ## $d
    ##  [1] -2.8276317 -3.1704241 -2.8735643 -3.5151651 -1.3897679 -2.5882179
    ##  [7] -3.6015345 -3.5370816 -2.9579875 -4.1882102 -3.5248356 -2.6181920
    ## [13] -3.8578110 -2.5709281 -3.4402075 -0.6845943 -2.8379316 -4.3696487
    ## [19] -2.4817169 -4.5658931

Pause and get my old function

``` r
mean_and_sd = function(x) {
  
  if (!is.numeric(x)) {
    stop("Argument x should be numeric")
    
  if (length(x) < 3) {
    stop("Input must have at least three numbers")
    }
    
  } else if (length(x) == 1) {
    stop("Z scores cannot be computed for length 1 vectors")
  }
  
 mean_x = mean(x)
 sd_x = sd(x)
  
tibble(
  mean = mean_x,
  sd = sd_x
)

}
```

I can apply that function to each list element

``` r
mean_and_sd(list_norm[[1]])
```

    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  3.32 0.837

``` r
mean_and_sd(list_norm[[2]])
```

    ## # A tibble: 1 x 2
    ##      mean    sd
    ##     <dbl> <dbl>
    ## 1 -0.0808  3.83

``` r
mean_and_sd(list_norm[[3]])
```

    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  9.99 0.216

``` r
mean_and_sd(list_norm[[4]])
```

    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1 -3.08 0.934

Let’s use a for loop

``` r
output = vector("list", length = 4)

for (i in 1:4) {
  output[[i]] = mean_and_sd(list_norm[[i]])
}
```

## Let’s try map\!

``` r
output = map(list_norm, mean_and_sd)
```

what if you want a different function?

``` r
output = map(list_norm, IQR)
```

``` r
output = map_df(list_norm, mean_and_sd, .id = "input")
```

## List columns\!

``` r
listcol_df = 
  tibble(
    name = c("a", "b", "c", "d"),
    samp = list_norm
  )
```

``` r
listcol_df %>% pull(name)
```

    ## [1] "a" "b" "c" "d"

``` r
listcol_df %>% pull(samp)
```

    ## $a
    ##  [1] 2.922404 3.127183 2.772952 3.492463 3.956003 4.264449 3.057104 3.957439
    ##  [9] 2.821668 2.943746 3.269228 3.978526 1.577132 3.019604 2.217397 3.275709
    ## [17] 3.114434 4.676677 2.684247 5.206172
    ## 
    ## $b
    ##  [1] -1.57511583  4.90932517 -0.16892460 -0.30827469  0.32416488  4.91805428
    ##  [7] -0.08356396 -0.72459601 -2.79705521 -5.40523334  0.53962930 -0.85857557
    ## [13] -8.19503303 -1.35298677 -0.14415564  3.36207855  0.32028494 -0.45958939
    ## [19]  4.55586153  2.18591720 -4.93872146  7.25693366  1.01320011  3.20834587
    ## [25] -5.27540115  4.58243042 -2.07466257 -6.97837891  5.23361760 -3.49412097
    ## 
    ## $c
    ##  [1] 10.008858 10.138616  9.829443  9.868863  9.922727  9.658375  9.808352
    ##  [8] 10.044111 10.074619 10.297830  9.703691  9.696770 10.087226 10.243660
    ## [15]  9.743809  9.960003 10.027672  9.892706 10.243072  9.715110 10.063978
    ## [22]  9.684168 10.271074 10.098806 10.308885 10.287393 10.150831 10.082851
    ## [29]  9.809180 10.336344  9.997826  9.656350  9.707188 10.175900 10.012713
    ## [36]  9.815042  9.696131 10.178422  9.865522 10.277250
    ## 
    ## $d
    ##  [1] -2.8276317 -3.1704241 -2.8735643 -3.5151651 -1.3897679 -2.5882179
    ##  [7] -3.6015345 -3.5370816 -2.9579875 -4.1882102 -3.5248356 -2.6181920
    ## [13] -3.8578110 -2.5709281 -3.4402075 -0.6845943 -2.8379316 -4.3696487
    ## [19] -2.4817169 -4.5658931

Let’s try some operations

``` r
mean_and_sd(listcol_df$samp[[1]])
```

    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  3.32 0.837

Can I just…map?

``` r
map(listcol_df$samp, mean_and_sd)
```

    ## $a
    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  3.32 0.837
    ## 
    ## $b
    ## # A tibble: 1 x 2
    ##      mean    sd
    ##     <dbl> <dbl>
    ## 1 -0.0808  3.83
    ## 
    ## $c
    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  9.99 0.216
    ## 
    ## $d
    ## # A tibble: 1 x 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1 -3.08 0.934

So….can I add a list column?

``` r
listcol_df %>% 
  mutate(summary = map(samp, mean_and_sd),
         medians = map_dbl(samp, median))
```

    ## # A tibble: 4 x 4
    ##   name  samp         summary          medians
    ##   <chr> <named list> <named list>       <dbl>
    ## 1 a     <dbl [20]>   <tibble [1 × 2]>   3.12 
    ## 2 b     <dbl [30]>   <tibble [1 × 2]>  -0.157
    ## 3 c     <dbl [40]>   <tibble [1 × 2]>  10.0  
    ## 4 d     <dbl [20]>   <tibble [1 × 2]>  -3.06
